dn: inum=2124-0CF1,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Cert authentication module
displayName: cert
oxEnabled: false
inum: 2124-0CF1
oxConfigurationProperty: {"value1":"chain_cert_file_path","value2":"/etc/certs/chain_cert.pem","description":""}
oxConfigurationProperty: {"value1":"credentials_file","value2":"/etc/certs/cert_creds.json","description":""}
oxConfigurationProperty: {"value1":"map_user_cert","value2":"true","description":""}
oxConfigurationProperty: {"value1":"use_generic_validator","value2":"true","description":""}
oxConfigurationProperty: {"value1":"use_path_validator","value2":"true","description":""}
oxConfigurationProperty: {"value1":"use_ocsp_validator","value2":"false","description":""}
oxConfigurationProperty: {"value1":"use_crl_validator","value2":"false","description":""}
oxConfigurationProperty: {"value1":"crl_max_response_size","value2":"10485760","description":""}
oxLevel: 30
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxRevision: 1
oxScript::%(person_authentication_usercertexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=2FDB-CF02,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
description: Passport authentication module
displayName: passport_social
oxEnabled: true
inum: 2FDB-CF02
oxConfigurationProperty: {"value1":"key_store_file","value2":"%(passport_rp_client_jks_fn)s","hide":false,"description":""}
oxConfigurationProperty: {"value1":"key_store_password","value2":"%(passport_rp_client_jks_pass)s","hide":false,"description":""}
oxLevel: 40
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_passportexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=CB5B-3211,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
description: Permission Dynamic Scope script
displayName: dynamic_permission
oxEnabled: false
inum: CB5B-3211
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(dynamic_scope_dynamic_permission)s
oxScriptType: dynamic_scope
programmingLanguage: python

dn: inum=031C-4A65,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Id Generator script
displayName: id_generator
oxEnabled: false
inum: 031C-4A65
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(id_generator_samplescript)s
oxScriptType: id_generator
programmingLanguage: python

dn: inum=031C-5621,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Dynamic Scope script for org_name
displayName: org_name
oxEnabled: false
inum: 031C-5621
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(dynamic_scope_org_name)s
oxScriptType: dynamic_scope
programmingLanguage: python

dn: inum=031C-5622,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Dynamic Scope script for work_phone
displayName: work_phone
oxEnabled: false
inum: 031C-5622
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(dynamic_scope_work_phone)s
oxScriptType: dynamic_scope
programmingLanguage: python

dn: inum=13D3-E7AD,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Cache Refresh script
displayName: cache_refresh
oxEnabled: false
inum: 13D3-E7AD
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(cache_refresh_samplescript)s
oxScriptType: cache_refresh
programmingLanguage: python

dn: inum=24FD-B96E,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
description: OTP Validation of passwords using Yubicloud authentication module
displayName: yubicloud
oxEnabled: false
inum: 24FD-B96E
oxConfigurationProperty: {"value1":"yubicloud_uri","value2":"api.yubico.com","description":""}
oxConfigurationProperty: {"value1":"yubicloud_api_key","value2":"","description":""}
oxConfigurationProperty: {"value1":"yubicloud_id","value2":"","description":""}
oxLevel: 40
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_yubicloudexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=2DAF-F995,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample UMA RPT Policy
displayName: uma_rpt_policy
oxEnabled: false
inum: 2DAF-F995
oxConfigurationProperty: {"value1":"allowed_clients","value2":"%(scim_rp_client_id)s, %(passport_rp_client_id)s","description":""}
oxLevel: 100
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(uma_rpt_policy_uma_rpt_policy)s
oxScriptType: uma_rpt_policy
programmingLanguage: python

dn: inum=2DAF-F9A5,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Client authorization UMA RPT Policy for SCIM and Passport
displayName: scim_access_policy
oxEnabled: %(enable_scim_access_policy)s
inum: 2DAF-F9A5
oxConfigurationProperty: {"value1":"allowed_clients","value2":"%(scim_rp_client_id)s, %(passport_rp_client_id)s","description":""}
oxLevel: 100
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(uma_rpt_policy_umaclientauthzrptpolicy)s
oxScriptType: uma_rpt_policy
programmingLanguage: python

dn: inum=OO11-BAFE,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Client authorization UMA RPT Policy for oxtrust api
displayName: oxtrust_api_access_policy
oxEnabled: %(enable_oxtrust_api_access_policy)s
inum: OO11-BAFE
oxConfigurationProperty: {"value1":"allowed_clients","value2":"%(oxtrust_requesting_party_client_id)s","description":""}
oxLevel: 100
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(uma_rpt_policy_umaclientauthzrptpolicy)s
oxScriptType: uma_rpt_policy
programmingLanguage: python

dn: inum=2DAF-F996,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample UMA Claims Gathering
displayName: sampleClaimsGathering
oxEnabled: false
inum: 2DAF-F996
oxLevel: 1
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(uma_claims_gathering_uma_claims_gathering)s
oxScriptType: uma_claims_gathering
programmingLanguage: python

dn: inum=2DAF-AA90,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Introspection Sample Script
displayName: introspection_sample
oxEnabled: false
inum: 2DAF-AA90
oxLevel: 1
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(introspection_introspection)s
oxScriptType: introspection
programmingLanguage: python

dn: inum=2DAF-BA90,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Introspection Custom Parameters Sample Script
displayName: introspection_custom_params
oxEnabled: false
inum: 2DAF-BA90
oxLevel: 1
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(introspection_introspection_custom_params)s
oxScriptType: introspection
programmingLanguage: python

dn: inum=2DAF-AA91,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Resource Owner Password Credentials Example
displayName: resource_owner_password_credentials_example
oxEnabled: false
inum: 2DAF-AA91
oxLevel: 1
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(resource_owner_password_credentials_resource_owner_password_credentials)s
oxScriptType: resource_owner_password_credentials
programmingLanguage: python

dn: inum=2DAF-BA91,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Resource Owner Password Credentials Custom Parameters Example
displayName: resource_owner_password_credentials_custom_params_example
oxEnabled: false
inum: 2DAF-BA91
oxLevel: 1
oxRevision: 1
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxScript::%(resource_owner_password_credentials_resource_owner_password_credentials_custom_params)s
oxScriptType: resource_owner_password_credentials
programmingLanguage: python

dn: inum=4BBE-C6A8,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Basic (with user locking) authentication module
displayName: basic_lock
oxEnabled: false
inum: 4BBE-C6A8
oxConfigurationProperty: {"value1":"invalid_login_count_attribute","value2":"oxCountInvalidLogin","description":""}
oxConfigurationProperty: {"value1":"maximum_invalid_login_attemps","value2":"3","description":""}
oxConfigurationProperty: {"value1":"lock_expiration_time","value2":"120","description":""}
oxLevel: 20
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxRevision: 1
oxScript::%(person_authentication_basiclockaccountexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=5018-AF9C,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: UAF authentication module
displayName: uaf
oxEnabled: false
inum: 5018-AF9C
oxConfigurationProperty: {"value1":"uaf_server_uri","value2":"https://%(hostname)s","description":""}
oxConfigurationProperty: {"value1":"uaf_policy_name","value2":"default","description":""}
oxConfigurationProperty: {"value1":"qr_options","value2":"{ width: 400, height: 400 }","description":""}
oxConfigurationProperty: {"value1":"registration_uri","value2":"https://%(hostname)s/identity/register","description":""}
oxConfigurationProperty: {"value1":"send_push_notifaction","value2":"false","description":""}
oxLevel: 70
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxRevision: 1
oxScript::%(person_authentication_uafexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=5018-D4BF,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: HOTP/TOPT authentication module
displayName: otp
oxEnabled: false
inum: 5018-D4BF
oxConfigurationProperty: {"value1":"otp_type","value2":"totp","description":""}
oxConfigurationProperty: {"value1":"otp_conf_file","value2":"/etc/certs/otp_configuration.json","description":""}
oxConfigurationProperty: {"value1":"issuer","value2":"Gluu Inc","description":""}
oxConfigurationProperty: {"value1":"label","value2":"Gluu OTP","description":""}
oxConfigurationProperty: {"value1":"qr_options","value2":"{ size: 400, mSize: 0.05 }","description":""}
oxConfigurationProperty: {"value1":"registration_uri","value2":"https://%(hostname)s/identity/register","description":""}
oxLevel: 40
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxRevision: 1
oxScript::%(person_authentication_otpexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=5018-F9CF,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: DUO authentication module
displayName: duo
oxEnabled: false
inum: 5018-F9CF
oxConfigurationProperty: {"value1":"duo_creds_file","value2":"/etc/certs/duo_creds.json","description":""}
oxConfigurationProperty: {"value1":"duo_host","value2":"api-random.duosecurity.com","description":""}
oxLevel: 50
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_duoexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=522F-CDC5,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Update User script
displayName: update_user
oxEnabled: false
inum: 522F-CDC5
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(update_user_samplescript)s
oxScriptType: update_user
programmingLanguage: python

dn: inum=6EA0-8F0C,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample User Registration script
displayName: user_registration
oxEnabled: false
inum: 6EA0-8F0C
oxConfigurationProperty: {"value1":"enable_user","value2":"false","description":""}
oxLevel: 90
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(user_registration_samplescript)s
oxScriptType: user_registration
programmingLanguage: python

dn: inum=6EA0-8F0D,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Confirm User Registration  script
displayName: user_confirm_registration
oxEnabled: false
inum: 6EA0-8F0D
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(user_registration_confirmregistrationsamplescript)s
oxScriptType: user_registration
programmingLanguage: python

dn: inum=8BAF-80D6,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Fido U2F authentication module
displayName: u2f
oxEnabled: false
inum: 8BAF-80D6
oxConfigurationProperty: {"value1":"u2f_application_id","value2":"https://%(hostname)s","description":""}
oxConfigurationProperty: {"value1":"u2f_server_uri","value2":"https://%(hostname)s","description":""}
oxLevel: 50
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_u2fexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=8BAF-80D7,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Fido2 authentication module
displayName: fido2
oxEnabled: false
inum: 8BAF-80D7
oxConfigurationProperty: {"value1":"fido2_server_uri","value2":"https://%(hostname)s","hide":false,"description":""}
oxLevel: 70
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_fido2externalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=92F0-BF9E,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Super Gluu authentication module
displayName: super_gluu
oxEnabled: false
inum: 92F0-BF9E
oxConfigurationProperty: {"value1":"qr_options","value2":"{ size: 500, mSize: 0.05 }","description":""}
oxConfigurationProperty: {"value1":"label","value2":"Super Gluu","description":""}
oxConfigurationProperty: {"value1":"registration_uri","value2":"https://%(hostname)s/identity/register","description":""}
oxConfigurationProperty: {"value1":"authentication_mode","value2":"two_step","description":""}
oxConfigurationProperty: {"value1":"notification_service_mode","value2":"gluu","description":""}
oxConfigurationProperty: {"value1":"credentials_file","value2":"/etc/certs/super_gluu_creds.json","description":""}
oxConfigurationProperty: {"value1":"supergluu_android_download_url","value2":"https://play.google.com/store/apps/details?id=gluu.org.super.gluu&hl=en_US","description":""}
oxConfigurationProperty: {"value1":"supergluu_ios_download_url","value2":"https://itunes.apple.com/us/app/super-gluu/id1093479646","description":""}
oxLevel: 60
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxRevision: 1
oxScript::%(person_authentication_supergluuexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=92F0-759E,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: ThumbSignIn authentication module
displayName: thumb_sign_in
oxEnabled: false
inum: 92F0-759E
oxConfigurationProperty: {"value1":"ts_host","value2":"https://ts.host.com","description":""}
oxConfigurationProperty: {"value1":"ts_apiKey","value2":"ts_api_key","description":""}
oxConfigurationProperty: {"value1":"ts_apiSecret","value2":"ts_api_secret","description":""}
oxLevel: 50
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxRevision: 1
oxScript::%(person_authentication_thumbsigninexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=A51E-76DA,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample authentication module
displayName: basic
oxEnabled: false
inum: A51E-76DA
oxLevel: 10
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_basicexternalauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=A910-56AB,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample script for SCIM events
displayName: scim_event_handler
oxEnabled: false
inum: A910-56AB
oxConfigurationProperty: {"value1":"testProp1","value2":"Test value 1","description":""}
oxConfigurationProperty: {"value1":"testProp2","value2":"Test value 2","description":""}
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(scim_samplescript)s
oxScriptType: scim
programmingLanguage: python

dn: inum=D40C-1CA4,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
description: Passport SAML authentication module
displayName: passport_saml
oxEnabled: %(gluuPassportEnabled)s
inum: D40C-1CA4
oxConfigurationProperty: {"value1":"key_store_file","value2":"%(passport_rp_client_jks_fn)s","hide":false,"description":""}
oxConfigurationProperty: {"value1":"key_store_password","value2":"%(passport_rp_client_jks_pass)s","hide":false,"description":""}
oxLevel: 60
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_samlpassportauthenticator)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=DAA9-B788,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Client Registration script
displayName: client_registration
oxEnabled: true
inum: DAA9-B788
oxLevel: 100
oxConfigurationProperty: {"value1":"client_redirect_uris","value2":"https://client.example.com/example1, https://client.example.com/example2","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(client_registration_samplescript)s
oxScriptType: client_registration
programmingLanguage: python

dn: inum=09A0-93D6,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Twilio SMS authentication module
displayName: twilio_sms
oxEnabled: false
inum: 09A0-93D6
oxConfigurationProperty: {"value1":"twilio_sid","value2":"","description":"Twilio account SID"}
oxConfigurationProperty: {"value1":"twilio_token","value2":"","description":"Twilio API token"}
oxConfigurationProperty: {"value1":"from_number","value2":"","description":"Twilio phone number with SMS capabilities"}
oxLevel: 50
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_twilio2fa)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=09A0-93D7,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: SMPP SMS authentication module
displayName: smpp
oxEnabled: false
inum: 09A0-93D7
oxConfigurationProperty: {"value1":"smpp_server","value2":"","description":"IP or FQDN of SMPP server"}
oxConfigurationProperty: {"value1":"smpp_port","value2":"","description":"TCP port of the SMPP server"}
oxConfigurationProperty: {"value1":"system_id","value2":"","description":"Use if SMPP server requires authentication"}
oxConfigurationProperty: {"value1":"password","value2":"","description":"Use if SMPP server requires authentication"}
oxConfigurationProperty: {"value1":"source_addr_ton","value2":"","description":"Type of number, eg ALPHANUMERIC, INTERNATIONAL"}
oxConfigurationProperty: {"value1":"source_addr","value2":"","description":"From number/name"}
oxLevel: 45
oxModuleProperty: {"value1":"usage_type","value2":"interactive","description":""}
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(person_authentication_smpp2fa)s
oxScriptType: person_authentication
programmingLanguage: python

dn: inum=DAA9-B789,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Sample Application Session script
displayName: application_session
oxEnabled: false
inum: DAA9-B789
oxLevel: 100
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(application_session_samplescript)s
oxScriptType: application_session
programmingLanguage: python

dn: inum=DAA9-BA60,ou=scripts,o=gluu
objectClass: top
objectClass: oxCustomScript
description: Consent Gathering script
displayName: consent_gathering
oxEnabled: false
inum: DAA9-BA60
oxLevel: 10
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxRevision: 1
oxScript::%(consent_gathering_consentgatheringsample)s
oxScriptType: consent_gathering
programmingLanguage: python

dn: inum=5042.79AF,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxEnabled: true
programmingLanguage: python
oxScript:: IyBveEF1dGggaXMgYXZhaWxhYmxlIHVuZGVyIHRoZSBNSVQgTGljZW5zZSAoMjAwOCkuIFNlZSBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUIGZvciBmdWxsIHRleHQuCiMgQ29weXJpZ2h0IChjKSAyMDE3LCBHbHV1CiMKIyBBdXRob3I6IEpvc2UgR29uemFsZXoKIyBBZGFwdGVkIGZyb20gcHJldmlvdXMgMy4wLjEgc2NyaXB0IG9mIFl1cml5IE1vdmNoYW4KIwoKZnJvbSBvcmcuZ2x1dS5veGF1dGgubW9kZWwudW1hIGltcG9ydCBVbWFDb25zdGFudHMKZnJvbSBvcmcuZ2x1dS5tb2RlbC51bWEgaW1wb3J0IENsYWltRGVmaW5pdGlvbkJ1aWxkZXIKZnJvbSBvcmcuZ2x1dS5tb2RlbC5jdXN0b20uc2NyaXB0LnR5cGUudW1hIGltcG9ydCBVbWFScHRQb2xpY3lUeXBlCmZyb20gb3JnLmdsdXUuc2VydmljZS5jZGkudXRpbCBpbXBvcnQgQ2RpVXRpbApmcm9tIG9yZy5nbHV1LnV0aWwgaW1wb3J0IFN0cmluZ0hlbHBlciwgQXJyYXlIZWxwZXIKZnJvbSBqYXZhLnV0aWwgaW1wb3J0IEFycmF5cywgQXJyYXlMaXN0LCBIYXNoU2V0CmZyb20gamF2YS5sYW5nIGltcG9ydCBTdHJpbmcKZnJvbSBvcmcuZ2x1dS5veGF1dGguc2VydmljZSBpbXBvcnQgQXV0aGVudGljYXRpb25TZXJ2aWNlCmZyb20gb3JnLmdsdXUub3hhdXRoLnNlcnZpY2UgaW1wb3J0IFVzZXJTZXJ2aWNlCmltcG9ydCBiYXNlNjQKaW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKCmNsYXNzIFVtYVJwdFBvbGljeShVbWFScHRQb2xpY3lUeXBlKToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgY3VycmVudFRpbWVNaWxsaXMpOgogICAgICAgIHNlbGYuY3VycmVudFRpbWVNaWxsaXMgPSBjdXJyZW50VGltZU1pbGxpcwoKICAgIGRlZiBpbml0KHNlbGYsIGNvbmZpZ3VyYXRpb25BdHRyaWJ1dGVzKToKICAgICAgICBwcmludCAiQXV0aGVudGljYXRlZCBSUFQgUG9saWN5LiBJbml0aWFsaXppbmcgLi4uIgogICAgICAgIHByaW50ICJBdXRoZW50aWNhdGVkIFJQVCBQb2xpY3kuIEluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseSIKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBkZXN0cm95KHNlbGYsIGNvbmZpZ3VyYXRpb25BdHRyaWJ1dGVzKToKICAgICAgICBwcmludCAiQXV0aGVudGljYXRlZCBSUFQgUG9saWN5LiBEZXN0cm95ZWQgc3VjY2Vzc2Z1bGx5IgogICAgICAgIHJldHVybiBUcnVlCgogICAgZGVmIGdldEFwaVZlcnNpb24oc2VsZik6CiAgICAgICAgcmV0dXJuIDEKCiAgICBkZWYgZ2V0UmVxdWlyZWRDbGFpbXMoc2VsZiwgY29udGV4dCk6CiAgICAgICAganNvbiA9ICIiIlsKICAgICAgICBdIiIiCiAgICAgICAgcmV0dXJuIENsYWltRGVmaW5pdGlvbkJ1aWxkZXIuYnVpbGQoanNvbikKCiAgICBkZWYgYXV0aG9yaXplKHNlbGYsIGNvbnRleHQpOiAjIGNvbnRleHQgaXMgcmVmZXJlbmNlIG9mIG9yZy5nbHV1Lm94YXV0aC51bWEuYXV0aG9yaXphdGlvbi5VbWFBdXRob3JpemF0aW9uQ29udGV4dAogICAgICAgIHByaW50ICJBdXRoZW50aWNhdGVkIFJQVCBQb2xpY3kuIEF1dGhvcml6aW5nIC4uLiIKICAgICAgICBhdXRoZW50aWNhdGlvblNlcnZpY2UgPSBDZGlVdGlsLmJlYW4oQXV0aGVudGljYXRpb25TZXJ2aWNlKQogICAgICAgIHVzZXJTZXJ2aWNlID0gQ2RpVXRpbC5iZWFuKFVzZXJTZXJ2aWNlKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNsYWltX3Rva2VuID0gY29udGV4dC5nZXRDbGFpbVRva2VuKCkKICAgICAgICAgICAgcGF5bG9hZCA9IHN0cihjbGFpbV90b2tlbikuc3BsaXQoIi4iKVsxXQogICAgICAgICAgICBwYWRkZWRQYXlsb2FkID0gcGF5bG9hZCArICc9JyAqICg0IC0gbGVuKHBheWxvYWQpICUgNCkKICAgICAgICAgICAgZGVjb2RlZCA9IGJhc2U2NC5iNjRkZWNvZGUocGFkZGVkUGF5bG9hZCkKICAgICAgICAgICAgdXNlckludW0gPSBqc29uLmxvYWRzKGRlY29kZWQpWyJzdWIiXQogICAgICAgICAgICB0b2tlbkV4cCA9IGludChqc29uLmxvYWRzKGRlY29kZWQpWyJleHAiXSkKICAgICAgICAgICAgcHJpbnQgdG9rZW5FeHAKICAgICAgICAgICAgdXNlciA9IHVzZXJTZXJ2aWNlLmdldFVzZXJCeUludW0odXNlckludW0pCiAgICAgICAgICAgIGxvZ2dlZF9pbiA9IGF1dGhlbnRpY2F0aW9uU2VydmljZS5hdXRoZW50aWNhdGUodXNlci5nZXRVc2VySWQoKSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHByaW50ICJBdXRoZW50aWNhdGVkIFJQVCBQb2xpY3kuIE5vIGNsYWltIHRva2VuIHBhc3NlZCEiCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICBpZiB0b2tlbkV4cCA8IGludCh0aW1lLnRpbWUoKSk6CiAgICAgICAgICAgICBwcmludCAiQXV0aGVudGljYXRlZCBSUFQgUG9saWN5LiBDbGFpbSB0b2tlbiBoYXMgZXhwaXJlZCEiCiAgICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgcHJpbnQgIkF1dGhlbnRpY2F0ZWQgUlBUIFBvbGljeS4gTG9nZ2VkIGluOiAiICsgc3RyKGxvZ2dlZF9pbikKCiAgICAgICAgaWYgbm90IGxvZ2dlZF9pbjoKICAgICAgICAgICAgcHJpbnQgIkF1dGhlbnRpY2F0ZWQgUlBUIFBvbGljeS4gVXNlciBpcyBub3QgYXV0aGVudGljYXRlZCEiCiAgICAgICAgICAgICNjbGllbnRJZCA9IGNvbnRleHQuZ2V0Q29uZmlndXJhdGlvbkF0dHJpYnV0ZXMoKS5nZXQoImNsaWVudF9pZCIpLmdldFZhbHVlMigpCiAgICAgICAgICAgICNyZWRpcmVjdFVyaSA9IGNvbnRleHQuZ2V0Q2xhaW1zR2F0aGVyaW5nRW5kcG9pbnQoKSArICI/YXV0aGVudGljYXRpb249dHJ1ZSIKICAgICAgICAgICAgI2F1dGhvcml6YXRpb25VcmwgPSBjb250ZXh0LmdldEF1dGhvcml6YXRpb25FbmRwb2ludCgpICsgIj9jbGllbnRfaWQ9IiArIGNsaWVudElkICsgIiZyZWRpcmVjdF91cmk9IiArIHJlZGlyZWN0VXJpICsgIiZzY29wZT1vcGVuaWQmcmVzcG9uc2VfdHlwZT1jb2RlIgogICAgICAgICAgICAjY29udGV4dC5yZWRpcmVjdFRvRXh0ZXJuYWxVcmwoYXV0aG9yaXphdGlvblVybCkKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQgIkF1dGhlbnRpY2F0ZWQgUlBUIFBvbGljeS4gVXNlciBpcyBhdXRoZW50aWNhdGVkLiIKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZ2V0Q2xhaW1zR2F0aGVyaW5nU2NyaXB0TmFtZShzZWxmLCBjb250ZXh0KToKICAgICAgICByZXR1cm4gVW1hQ29uc3RhbnRzLk5PX1NDUklQVAo=
inum: 5042.79AF
description: Check if user is authenticated (logged on) with Gluu
oxScriptType: uma_rpt_policy
oxRevision: 44
oxLevel: 100
displayName: scim_authenticated_policy

# open policy script
dn: inum=B1B9.DADB,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxEnabled: true
programmingLanguage: python
oxScript:: ZnJvbSBvcmcuZ2x1dS5tb2RlbC5jdXN0b20uc2NyaXB0LnR5cGUudW1hIGltcG9ydCBVbWFScHRQb2xpY3lUeXBlCgpjbGFzcyBVbWFScHRQb2xpY3koVW1hUnB0UG9saWN5VHlwZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY3VycmVudFRpbWVNaWxsaXMpOgogICAgICAgIHNlbGYuY3VycmVudFRpbWVNaWxsaXMgPSBjdXJyZW50VGltZU1pbGxpcwoKICAgIGRlZiBpbml0KHNlbGYsIGNvbmZpZ3VyYXRpb25BdHRyaWJ1dGVzKToKICAgICAgICBwcmludCAiT3BlbiBQb2xpY3kuIEluaXRpYWxpemluZyAuLi4iCiAgICAgICAgcHJpbnQgIk9wZW4gUG9saWN5LiBJbml0aWFsaXplZCBzdWNjZXNzZnVsbHkiCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZGVzdHJveShzZWxmLCBjb25maWd1cmF0aW9uQXR0cmlidXRlcyk6CiAgICAgICAgcHJpbnQgIk9wZW4gUG9saWN5LiBEZXN0cm95aW5nIC4uLiIKICAgICAgICBwcmludCAiT3BlbiBQb2xpY3kuIERlc3Ryb3llZCBzdWNjZXNzZnVsbHkiCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZ2V0QXBpVmVyc2lvbihzZWxmKToKICAgICAgICByZXR1cm4gMQoKICAgIGRlZiBhdXRob3JpemUoc2VsZiwgY29udGV4dCk6CiAgICAgICAgcHJpbnQgIkF1dGhvcml6ZWQgc3VjY2Vzc2Z1bGx5ISIKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBnZXRSZXF1aXJlZENsYWltcyhzZWxmLCBjb250ZXh0KToKICAgICAgICByZXR1cm4gW10KICAgCiAgICBkZWYgZ2V0Q2xhaW1zR2F0aGVyaW5nU2NyaXB0TmFtZShzZWxmLCBjb250ZXh0KToKICAgICAgICByZXR1cm4gInNhbXBsZUNsYWltc0dhdGhlcmluZyI=
inum: B1B9.DADB
oxScriptType: uma_rpt_policy
oxRevision: 45
oxLevel: 100
displayName: open_policy

# protected access policy
dn: inum=4D35.5AE9,ou=scripts,o=gluu
objectClass: oxCustomScript
objectClass: top
oxModuleProperty: {"value1":"location_type","value2":"ldap","description":""}
oxEnabled: true
programmingLanguage: python
oxScript:: IyBveEF1dGggaXMgYXZhaWxhYmxlIHVuZGVyIHRoZSBNSVQgTGljZW5zZSAoMjAwOCkuIFNlZSBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUIGZvciBmdWxsIHRleHQuCiMgQ29weXJpZ2h0IChjKSAyMDE3LCBHbHV1CiMKIyBBdXRob3I6IFRpYWdvIEZlcm5hbmRlcwojCgpmcm9tIG9yZy5nbHV1Lm94YXV0aC5tb2RlbC51bWEgaW1wb3J0IFVtYUNvbnN0YW50cwpmcm9tIG9yZy5nbHV1Lm1vZGVsLnVtYSBpbXBvcnQgQ2xhaW1EZWZpbml0aW9uQnVpbGRlcgpmcm9tIG9yZy5nbHV1Lm1vZGVsLmN1c3RvbS5zY3JpcHQudHlwZS51bWEgaW1wb3J0IFVtYVJwdFBvbGljeVR5cGUKZnJvbSBvcmcuZ2x1dS5zZXJ2aWNlLmNkaS51dGlsIGltcG9ydCBDZGlVdGlsCmZyb20gb3JnLmdsdXUudXRpbCBpbXBvcnQgU3RyaW5nSGVscGVyLCBBcnJheUhlbHBlcgpmcm9tIGphdmEudXRpbCBpbXBvcnQgQXJyYXlzLCBBcnJheUxpc3QsIEhhc2hTZXQKZnJvbSBqYXZhLmxhbmcgaW1wb3J0IFN0cmluZwpmcm9tIG9yZy5nbHV1Lm94YXV0aC5zZXJ2aWNlIGltcG9ydCBBdXRoZW50aWNhdGlvblNlcnZpY2UKZnJvbSBvcmcuZ2x1dS5veGF1dGguc2VydmljZSBpbXBvcnQgVXNlclNlcnZpY2UKaW1wb3J0IGJhc2U2NAppbXBvcnQganNvbgppbXBvcnQgdGltZQppbXBvcnQgaHR0cGxpYgoKY2xhc3MgVW1hUnB0UG9saWN5KFVtYVJwdFBvbGljeVR5cGUpOgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjdXJyZW50VGltZU1pbGxpcyk6CiAgICAgICAgc2VsZi5jdXJyZW50VGltZU1pbGxpcyA9IGN1cnJlbnRUaW1lTWlsbGlzCgogICAgZGVmIGluaXQoc2VsZiwgY29uZmlndXJhdGlvbkF0dHJpYnV0ZXMpOgogICAgICAgIHByaW50ICJQcm90ZWN0ZWQgQWNjZXNzIFBvbGljeS4gSW5pdGlhbGl6aW5nIC4uLiIKICAgICAgICBpZiBub3QgY29uZmlndXJhdGlvbkF0dHJpYnV0ZXMuY29udGFpbnNLZXkoInBkcF9ob3N0bmFtZSIpOgogICAgICAgICAgICBwcmludCAiUHJvdGVjdGVkIEFjY2VzcyBQb2xpY3kgaW5pdCBlcnJvciwgcGRwIGhvc3RuYW1lIG5vdCBzcGVjaWZpZWQhIgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBzZWxmLnBkcF9ob3N0bmFtZSA9IHN0cihjb25maWd1cmF0aW9uQXR0cmlidXRlcy5nZXQoInBkcF9ob3N0bmFtZSIpLmdldFZhbHVlMigpKQoKICAgICAgICBpZiBub3QgY29uZmlndXJhdGlvbkF0dHJpYnV0ZXMuY29udGFpbnNLZXkoInBkcF9lbmRwb2ludCIpOgogICAgICAgICAgICBwcmludCAiUHJvdGVjdGVkIEFjY2VzcyBQb2xpY3kgaW5pdCBlcnJvciwgcGRwIGVuZHBvaW50IG5vdCBzcGVjaWZpZWQhIgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBzZWxmLnBkcF9lbmRwb2ludCA9IHN0cihjb25maWd1cmF0aW9uQXR0cmlidXRlcy5nZXQoInBkcF9lbmRwb2ludCIpLmdldFZhbHVlMigpKQogICAgICAgIHByaW50ICJQcm90ZWN0ZWQgQWNjZXNzIFBvbGljeS4gUERQIGVuZHBvaW50IHNldCB0bzogIiArIHNlbGYucGRwX2hvc3RuYW1lICsgc2VsZi5wZHBfZW5kcG9pbnQKICAgICAgICBwcmludCAiUHJvdGVjdGVkIEFjY2VzcyBQb2xpY3kuIEluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseSIKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBkZXN0cm95KHNlbGYsIGNvbmZpZ3VyYXRpb25BdHRyaWJ1dGVzKToKICAgICAgICBwcmludCAiUHJvdGVjdGVkIEFjY2VzcyBQb2xpY3kuIERlc3Ryb3llZCBzdWNjZXNzZnVsbHkiCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgZ2V0QXBpVmVyc2lvbihzZWxmKToKICAgICAgICByZXR1cm4gMQoKICAgIGRlZiBnZXRSZXF1aXJlZENsYWltcyhzZWxmLCBjb250ZXh0KToKICAgICAgICBqc29uID0gIiIiWwogICAgICAgIF0iIiIKICAgICAgICByZXR1cm4gQ2xhaW1EZWZpbml0aW9uQnVpbGRlci5idWlsZChqc29uKQoKICAgIGRlZiBhdXRob3JpemUoc2VsZiwgY29udGV4dCk6ICMgY29udGV4dCBpcyByZWZlcmVuY2Ugb2Ygb3JnLmdsdXUub3hhdXRoLnVtYS5hdXRob3JpemF0aW9uLlVtYUF1dGhvcml6YXRpb25Db250ZXh0CiAgICAgICAgcHJpbnQgIlByb3RlY3RlZCBBY2Nlc3MgUG9saWN5LiBBdXRob3JpemluZyAuLi4iCiAgICAgICAgCiAgICAgICAgdXNlcm5hbWU9IiIKICAgICAgICBjbGFpbVRva2VuPSIiCiAgICAgICAgcmVzb3VyY2VJRExpc3Q9IiIKICAgICAgICAKICAgICAgICBhdXRoZW50aWNhdGlvblNlcnZpY2UgPSBDZGlVdGlsLmJlYW4oQXV0aGVudGljYXRpb25TZXJ2aWNlKQogICAgICAgIHVzZXJTZXJ2aWNlID0gQ2RpVXRpbC5iZWFuKFVzZXJTZXJ2aWNlKQogICAgICAgIAogICAgICAgIHRyeToKICAgICAgICAgICAgY2xhaW1Ub2tlbiA9IGNvbnRleHQuZ2V0Q2xhaW1Ub2tlbigpCiAgICAgICAgICAgIHBheWxvYWQgPSBzdHIoY2xhaW1Ub2tlbikuc3BsaXQoIi4iKVsxXQogICAgICAgICAgICBwYWRkZWRQYXlsb2FkID0gcGF5bG9hZCArICc9JyAqICg0IC0gbGVuKHBheWxvYWQpICUgNCkKICAgICAgICAgICAgZGVjb2RlZCA9IGJhc2U2NC5iNjRkZWNvZGUocGFkZGVkUGF5bG9hZCkKICAgICAgICAgICAgdXNlckludW0gPSBqc29uLmxvYWRzKGRlY29kZWQpWyJzdWIiXQogICAgICAgICAgICB1c2VybmFtZSA9IHVzZXJTZXJ2aWNlLmdldFVzZXJCeUludW0odXNlckludW0pLmdldFVzZXJJZCgpCiAgICAgICAgICAgIHJlc291cmNlSURMaXN0ID0gY29udGV4dC5nZXRSZXNvdXJjZUlkcygpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludCAiUHJvdGVjdGVkIEFjY2VzcyBQb2xpY3kuIE5vIGNsYWltIHRva2VuIHBhc3NlZCEiCiAgICAgICAgICAgIHByaW50IHN0cihlKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgI2ZpbGwgcmVxdWVzdCBmb3JtCiAgICAgICAgcmVxdWVzdCA9IHt9CiAgICAgICAgI0FkZCBBY2Nlc3MgU3ViamVjdCB3aXRoIHVzZXJfaWQgYW5kIGNsYWltX3Rva2VuIGF0dHJpYnV0ZXMKICAgICAgICBhdHRyaWJ1dGVfdXNlcl9pZCA9IHsgIkF0dHJpYnV0ZUlkIjogInVzZXJfaWQiLCAiVmFsdWUiOiBzdHIodXNlcm5hbWUpLCAiRGF0YVR5cGUiOiAic3RyaW5nIiwgIkluY2x1ZGVJblJlc3VsdCI6IFRydWUgfQogICAgICAgIGF0dHJpYnV0ZV9jbGFpbV90b2tlbiA9IHsiQXR0cmlidXRlSWQiOiAiY2xhaW1fdG9rZW4iLCAiVmFsdWUiOiBzdHIoY2xhaW1Ub2tlbiksICJEYXRhVHlwZSI6ICJzdHJpbmciLCAiSW5jbHVkZUluUmVzdWx0IjogVHJ1ZX0KICAgICAgICBhY2Nlc3Nfc3ViamVjdF9hdHRyaWJ1dGVzID0gW2F0dHJpYnV0ZV91c2VyX2lkLCBhdHRyaWJ1dGVfY2xhaW1fdG9rZW5dCiAgICAgICAgYWNjZXNzU3ViamVjdCA9IHsiQXR0cmlidXRlIjogYWNjZXNzX3N1YmplY3RfYXR0cmlidXRlc30KICAgICAgICBhY2Nlc3Nfc3ViamVjdF9saXN0ID0gW2FjY2Vzc1N1YmplY3RdCiAgICAgICAgcmVxdWVzdC51cGRhdGUoeyJBY2Nlc3NTdWJqZWN0IjogYWNjZXNzX3N1YmplY3RfbGlzdH0pCgogICAgICAgICNBZGQgQWN0aW9uLCB0aGUgZGVmYXVsdCBpcyAidmlldyIgYnV0IGNhbiBlYXNpbHkgYmUgZXh0ZW5kZWQgaW4gdGhlIGZ1dHVyZQogICAgICAgIGF0dHJpYnV0ZV9hY3Rpb25fdmlldyA9IHsiQXR0cmlidXRlSWQiOiAiYWN0aW9uLWlkIiwgIlZhbHVlIjogInZpZXcifQogICAgICAgIGFjdGlvbl9hdHRyaWJ1dGVfbGlzdCA9IFthdHRyaWJ1dGVfYWN0aW9uX3ZpZXddCiAgICAgICAgYXR0cmlidXRlX2FjdGlvbiA9IHsiQXR0cmlidXRlIjogYWN0aW9uX2F0dHJpYnV0ZV9saXN0fQogICAgICAgIGFjdGlvbl9saXN0ID0gW2F0dHJpYnV0ZV9hY3Rpb25dCiAgICAgICAgcmVxdWVzdC51cGRhdGUoeyJBY3Rpb24iOiBhY3Rpb25fbGlzdH0pCgogICAgICAgICNBZGQgUmVzb3VyY2VzIGFzIGEgbGlzdAogICAgICAgICNFYWNoIHJlc291cmNlIGNvbnRhaW5zIGEgbGlzdCBvZiBhdHRyaWJ1dGVzIHRvIGNoYXJhY3Rlcml6ZSBpdAogICAgICAgICNSaWdodCBub3csIHJlc291cmNlcyBhcmUganVzdCBjaGFyYWN0ZXJpemVkIGJ5IHRoZWlyIHJlc291cmNlLWlkLiBDYW4gYmUgZXhwYW5kZWQgaW4gdGhlIGZ1dHVyZQogICAgICAgIHJlc291cmNlX2xpc3QgPSBbXQogICAgICAgIGZvciByZXNvdXJjZSBpbiByZXNvdXJjZUlETGlzdDoKICAgICAgICAgICAgcmVzb3VyY2VfYXR0cmlidXRlX2lkID0geyJBdHRyaWJ1dGVJZCI6ICJyZXNvdXJjZS1pZCIsICJWYWx1ZSI6IHN0cihyZXNvdXJjZSksICJEYXRhVHlwZSI6ICJzdHJpbmciLCAiSW5jbHVkZUluUmVzdWx0IjogVHJ1ZSB9CiAgICAgICAgICAgIHJlc291cmNlX2F0dHJpYnV0ZSA9IHsiQXR0cmlidXRlIjogW3Jlc291cmNlX2F0dHJpYnV0ZV9pZF19CiAgICAgICAgICAgIHJlc291cmNlX2xpc3QuYXBwZW5kKHJlc291cmNlX2F0dHJpYnV0ZSkKICAgICAgICByZXF1ZXN0LnVwZGF0ZSh7IlJlc291cmNlIjogcmVzb3VyY2VfbGlzdH0pCgogICAgICAgICNCdWlsZCByZXF1ZXN0IGZvcm0gaW4gSlNPTiBmb3JtYXQKICAgICAgICByZXF1ZXN0Rm9ybSA9IHsiUmVxdWVzdCI6IHJlcXVlc3R9CgogICAgICAgICNNYWtlIHJlcXVlc3QgdG8gUERQCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoZWFkZXJzPXsnY29udGVudC10eXBlJzogImFwcGxpY2F0aW9uL2pzb24iLCAiQWNjZXB0IjogInRleHQvcGxhaW4ifQogICAgICAgICAgICBjb25uID0gaHR0cGxpYi5IVFRQQ29ubmVjdGlvbihzZWxmLnBkcF9ob3N0bmFtZSkKICAgICAgICAgICAgY29ubi5yZXF1ZXN0KCJHRVQiLCBzZWxmLnBkcF9lbmRwb2ludCwgYm9keT1qc29uLmR1bXBzKHJlcXVlc3RGb3JtKSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgICAgICByZXNwID0gY29ubi5nZXRyZXNwb25zZSgpLnJlYWQoKQoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcGRwUmVwbHkgPSBldmFsKHJlc3ApCiAgICAgICAgICAgICAgICBkZWNpc2lvbiA9IHN0cihwZHBSZXBseVsiUmVzcG9uc2UiXVswXVsiRGVjaXNpb24iXSkKICAgICAgICAgICAgICAgIGlmIGRlY2lzaW9uID09ICJQZXJtaXQiOgogICAgICAgICAgICAgICAgICAgIHByaW50ICJQcm90ZWN0ZWQgQWNjZXNzIFBvbGljeS4gQWNjZXNzIGdyYW50ZWQhIgogICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgICAgICBwcmludCAiUHJvdGVjdGVkIEFjY2VzcyBQb2xpY3kuIEFjY2VzcyBkZW5pZWQhIgogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHByaW50ICJQcm90ZWN0ZWQgQWNjZXNzIFBvbGljeS4gRXhjZXB0aW9uIG9jY3VyZWQ6IgogICAgICAgICAgICAgICAgcHJpbnQgc3RyKGUpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQgIlByb3RlY3RlZCBBY2Nlc3MgUG9saWN5LiBGYWlsdXJlIHRvIGNvbm5lY3QgdG8gUERQLiIKICAgICAgICAgICAgcHJpbnQgc3RyKGUpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGRlZiBnZXRDbGFpbXNHYXRoZXJpbmdTY3JpcHROYW1lKHNlbGYsIGNvbnRleHQpOgogICAgICAgIHJldHVybiBVbWFDb25zdGFudHMuTk9fU0NSSVBU
inum: 4D35.5AE9
description: Policy that connects with PDP to check resource access
oxScriptType: uma_rpt_policy
oxRevision: 10
oxConfigurationProperty: {"value1":"pdp_endpoint","value2":"/policy/validate","hide":false,"description":""}
oxConfigurationProperty: {"value1":"pdp_hostname","value2":"%(hostname)s:31708","hide":false,"description":""}
oxLevel: 100
displayName: scim_protected_policy
